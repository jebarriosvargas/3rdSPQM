# Aislates topológicos de orden superior


```{python}

from pylab import *
from pythtb import *

mpl.rcParams['figure.figsize'] = (2.5,2.5)

δ    = 1e-6
cint = 1
cext = 2

lat  = [[1,0],[0,1]]
orb  = [[0,0],[0.5,0],[0,0.5],[0.5,0.5]]

HOTI = tb_model(2, 2, lat, orb)

HOTI.set_onsite( [δ, -δ, δ, -δ] )

HOTI.set_hop(           cint, 0, 1, [ 0, 0])
HOTI.set_hop(exp(1J*pi)*cint, 0, 2, [ 0, 0])
HOTI.set_hop(           cint, 1, 3, [ 0, 0])
HOTI.set_hop(           cint, 2, 3, [ 0, 0])

HOTI.set_hop(           cext, 0, 1, [-1, 0])
HOTI.set_hop(           cext, 0, 2, [ 0,-1])
HOTI.set_hop(exp(1J*pi)*cext, 1, 3, [ 0,-1])
HOTI.set_hop(           cext, 2, 3, [-1, 0])

```
```{python}
Nx,Ny = 4,4
HOTI_slab     =      HOTI.cut_piece(Nx,0,glue_edgs=False)
HOTI_square   = HOTI_slab.cut_piece(Ny,1,glue_edgs=False)
(evals,evecs) = HOTI_square.solve_all(eig_vectors=True)
```

```{python}

hlines(evals,xmin=0.1,xmax=0.2)

```

```{python}
def local_DOS_one_eigen(Ek,U,n):
    S = array( [ conj(U[n,i])*U[n,i] for i in range(len(Ek)) ] )
    return real(S)
```

```{python}
ed=HOTI_square.get_num_orbitals()//2-2
(fig,ax)=HOTI_square.visualize(0,1,eig_dr=evecs[ed,:],draw_hoppings=True)
ax.set_title("E={0:.2e}".format(evals[ed]))
ax.set_xlabel("x coordinate")
ax.set_ylabel("y coordinate")
fig.tight_layout()
```